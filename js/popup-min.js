var writeusLink=document.querySelector(".writeus-button"),popup=document.querySelector(".writeus"),popupClose=popup.querySelector(".writeus-close"),formPopup=popup.querySelector("form"),nameField=formPopup.querySelector(".js-popup-name"),emailField=formPopup.querySelector(".js-popup-email"),letterField=formPopup.querySelector(".js-popup-textarea"),popupSubmitButton=formPopup.querySelector(".js-popup-submitButton"),storageName="",storageEmail="",isStorageSupport=!0;try{storageName=localStorage.getItem("nameField"),storageEmail=localStorage.getItem("emailField")}catch(e){isStorageSupport=!1}nameField.required=!1,emailField.required=!1,letterField.required=!1,writeusLink.addEventListener("click",function(e){e.preventDefault(),popup.classList.add("writeus-show"),storageName?(nameField.value=storageName,storageEmail?(emailField.value=storageEmail,letterField.value?popupSubmitButton.focus():letterField.focus()):emailField.focus()):nameField.focus()}),formPopup.addEventListener("submit",function(e){if(nameField.value&&emailField.value&&letterField.value)isStorageSupport&&(localStorage.setItem("nameField",nameField.value),localStorage.setItem("emailField",emailField.value));else{if(e.preventDefault(),popup.classList.remove("writeus-error"),popup.offsetWidth=popup.offsetWidth,popup.classList.add("writeus-error"),!nameField.value)return void nameField.focus();if(!emailField.value)return void emailField.focus();letterField.focus()}}),popupClose.addEventListener("click",function(e){e.preventDefault(),popup.classList.remove("writeus-show"),popup.classList.remove("writeus-error")}),window.addEventListener("keydown",function(e){27===e.keyCode&&popup.classList.contains("writeus-show")&&(e.preventDefault(),popup.classList.remove("writeus-show"),popup.classList.remove("writeus-error"))});